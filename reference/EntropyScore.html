<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Cell-Level Chromatin State Entropy (Plasticity) Scores — EntropyScore • chromatic</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Montserrat-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Calculate Cell-Level Chromatin State Entropy (Plasticity) Scores — EntropyScore"><meta name="description" content="Computes per-cell entropy scores from a chromatin state count matrix.
This function normalizes counts to fractions and then calculates
Shannon entropy for each cell to quantify the diversity of chromatin
states (a proxy for epigenomic plasticity). Optionally, it can regress
out covariates (e.g. sequencing depth, TSS enrichment) to return
a covariate-corrected entropy score."><meta property="og:description" content="Computes per-cell entropy scores from a chromatin state count matrix.
This function normalizes counts to fractions and then calculates
Shannon entropy for each cell to quantify the diversity of chromatin
states (a proxy for epigenomic plasticity). Optionally, it can regress
out covariates (e.g. sequencing depth, TSS enrichment) to return
a covariate-corrected entropy score."><link rel="stylesheet" href="extra.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">chromatic</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.03</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes"><li><a class="dropdown-item" href="../articles/scATAC.html">scATAC-seq tutorial</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changes</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/smorabit/chromatic/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Calculate Cell-Level Chromatin State Entropy (Plasticity) Scores</h1>
      <small class="dont-index">Source: <a href="https://github.com/smorabit/chromatic/blob/main/R/scoring.R" class="external-link"><code>R/scoring.R</code></a></small>
      <div class="d-none name"><code>EntropyScore.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes per-cell entropy scores from a chromatin state count matrix.
This function normalizes counts to fractions and then calculates
Shannon entropy for each cell to quantify the diversity of chromatin
states (a proxy for epigenomic plasticity). Optionally, it can regress
out covariates (e.g. sequencing depth, TSS enrichment) to return
a covariate-corrected entropy score.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EntropyScore</span><span class="op">(</span><span class="va">mat</span>, <span class="va">meta</span>, covariates <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mat">mat<a class="anchor" aria-label="anchor" href="#arg-mat"></a></dt>
<dd><p>A numeric matrix of chromatin state counts
(rows = cells, columns = states). Typically generated by <code><a href="CalculateStateMatrix.html">CalculateStateMatrix()</a></code>.</p></dd>


<dt id="arg-meta">meta<a class="anchor" aria-label="anchor" href="#arg-meta"></a></dt>
<dd><p>A data frame of cell-level metadata (e.g. <code>seurat_obj@meta.data</code>).
Required if <code>covariates</code> is provided.</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>Optional character vector of column names in <code>meta</code>
specifying covariates to regress out of the entropy score. Default = <code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with:</p><ul><li><p><code>entropy</code>: raw Shannon entropy score per cell (in bits).</p></li>
<li><p><code>entropy_norm</code>: entropy normalized to 0–1 range by
dividing by <code>log2(n_states)</code>.</p></li>
<li><p><code>entropy_corrected</code> (if <code>covariates</code> given):
residual entropy score with covariates regressed out.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each cell:</p><ol><li><p>Convert counts to per-cell fractions with pseudocount.</p></li>
<li><p>Compute Shannon entropy of the fraction vector
(<code>entropy::entropy(p, unit="log2")</code>).</p></li>
<li><p>Normalize the entropy score by dividing by <code>log2(n_states)</code>
(maximum possible entropy) to scale it between 0 and 1.</p></li>
</ol><p>If <code>covariates</code> is supplied, a linear model is fit with the specified
covariates as predictors of the raw entropy score. The residuals from this model
are returned as the covariate-corrected entropy score.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ErosionScore.html">ErosionScore</a></code>, <code><a href="CalculateStateMatrix.html">CalculateStateMatrix</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://smorabit.github.io" class="external-link">Sam Morabito</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

