% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scoring.R
\name{AnnotatePeaks}
\alias{AnnotatePeaks}
\title{Annotate Peaks with Chromatin States}
\usage{
AnnotatePeaks(
  peaks_gr,
  chromHMM_states,
  state_col = "name",
  keep_unannotated = FALSE,
  min_overlap = 1
)
}
\arguments{
\item{peaks_gr}{A \code{GRanges} object of peak regions to annotate.}

\item{chromHMM_states}{A \code{GRanges} object of ChromHMM state annotations.
Must contain a metadata column (default \code{"name"}) specifying state names.}

\item{state_col}{Character string specifying the metadata column in
\code{chromHMM_states} containing state labels. Default = \code{"name"}.}

\item{keep_unannotated}{Logical; if \code{TRUE}, peaks without overlaps
to any ChromHMM state are returned with \code{NA} in their \code{annotation} column.
If \code{FALSE} (default), unannotated peaks are dropped.}

\item{min_overlap}{Numeric; minimum overlap width (in bp) required for a peak
to be assigned to a ChromHMM state. Peaks whose maximum overlap is below this
threshold will be considered unannotated. Default = \code{1} (any overlap).}
}
\value{
A \code{GRanges} object of peaks with added metadata columns:
\itemize{
\item \code{annotation} — the ChromHMM state label.
\item \code{overlap_width} — width of overlap between the peak and
its assigned ChromHMM state.
}
}
\description{
Assigns each peak in a \code{GRanges} object to the chromatin state with
which it has the largest overlap from a ChromHMM \code{GRanges} annotation.
This function is typically used to annotate peaks before computing
state-level metrics (e.g., erosion or entropy scores).
}
\details{
For each peak:
\enumerate{
\item The function finds all overlaps between peaks and ChromHMM states.
\item It computes the width of each overlap.
\item It assigns to each peak the state with the largest overlap
(if \code{min_overlap} is met).
\item It stores the overlap width in a new metadata column
(\code{overlap_width}).
\item By default, peaks without any overlap are dropped
(set \code{keep_unannotated=TRUE} to retain them).
}
}
\examples{
\dontrun{
annotated_peaks <- AnnotatePeaks(
  peaks_gr = peaks_gr,
  chromHMM_states = chromHMM_states,
  state_col = "name",
  keep_unannotated = TRUE,
  min_overlap = 50
)
}

}
\seealso{
\code{\link{ChromatinStateSigns}}, \code{\link{ErosionScore}}
}
