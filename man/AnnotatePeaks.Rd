% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scoring.R
\name{AnnotatePeaks}
\alias{AnnotatePeaks}
\title{Annotate Peaks with Chromatin States}
\usage{
AnnotatePeaks(
  peaks_gr,
  chromHMM_states,
  state_col = "name",
  keep_unannotated = FALSE,
  min_overlap = 1,
  min_overlap_frac = NULL,
  verbose = TRUE
)
}
\arguments{
\item{peaks_gr}{A \code{GRanges} object of peak regions to annotate.}

\item{chromHMM_states}{A \code{GRanges} object of ChromHMM state annotations.
Must contain a metadata column (default \code{"name"}) specifying state names.}

\item{state_col}{Character string specifying the metadata column in
\code{chromHMM_states} containing state labels. Default = \code{"name"}.}

\item{keep_unannotated}{Logical; if \code{TRUE}, peaks without qualifying overlaps
to any ChromHMM state are retained with \code{NA} in their \code{annotation} column.
If \code{FALSE} (default), unannotated peaks are dropped.}

\item{min_overlap}{Numeric; minimum overlap width (in bp) required for a peak
to be assigned to a ChromHMM state. Default = \code{1} (any overlap).}

\item{min_overlap_frac}{Optional numeric; minimum fraction of a peak's length that
must overlap a ChromHMM state for assignment. Must be between 0 and 1.
If \code{NULL} (default), no fraction filter is applied.}

\item{verbose}{Logical; if \code{TRUE} (default), prints a summary message about
peaks removed due to overlap thresholds.}
}
\value{
A \code{GRanges} object of peaks with added metadata columns:
\itemize{
\item \code{annotation} — the ChromHMM state label.
\item \code{overlap_width} — width of overlap between the peak and
its assigned ChromHMM state.
\item \code{overlap_frac} — fraction of the peak length overlapping the state.
}
}
\description{
Assigns each peak in a \code{GRanges} object to the chromatin state with
which it has the largest overlap from a ChromHMM \code{GRanges} annotation.
Supports filtering by both absolute and fractional overlap requirements.
}
\details{
For each peak:
\enumerate{
\item The function finds all overlaps between peaks and ChromHMM states.
\item It computes the absolute overlap width and fractional overlap relative
to peak length.
\item It assigns each peak to the state with the largest overlap, subject to
\code{min_overlap} and \code{min_overlap_frac} thresholds.
\item Overlap statistics are stored in new metadata columns.
\item Peaks that fail the filters are optionally retained (\code{keep_unannotated})
or dropped (default).
}
}
\seealso{
\code{\link{ChromatinStateSigns}}, \code{\link{ErosionScore}}
}
