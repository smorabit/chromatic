% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scoring.R
\name{ErosionScore}
\alias{ErosionScore}
\title{Calculate Erosion Scores from Chromatin State Matrices}
\usage{
ErosionScore(mat, meta, state_signs, covariates = NULL)
}
\arguments{
\item{mat}{A numeric matrix of chromatin states as columns an cells as rows
and states as columns. Typically produced by \code{CalculateStateMatrix()}.}

\item{meta}{A data frame (such as \code{seurat_obj@meta.data}) containing
cell-level metadata. Required if covariate regression is to be performed.}

\item{state_signs}{A named numeric vector indicating the sign (+1 or -1)
for each chromatin state. Names must match the column names of \code{input}.}

\item{covariates}{A character vector of column names in \code{meta}
specifying which covariates to regress out of the erosion score. Default is \code{NULL}.}
}
\value{
A data frame with:
\itemize{
\item \code{erosion_score}: the raw erosion score per cell.
\item \code{erosion_score_corrected} (if covariates given): residual
erosion score with covariates regressed out.
}.
}
\description{
Computes cell-level epigenomic erosion scores from a chromatin state
count matrix. The function performs fraction normalization,
centered log-ratio (CLR) transformation, z-scoring, and applies a
state-specific sign vector (+1 for repressive states, -1 for active states).
Optionally, it can regress out covariates (e.g., TSS enrichment,
nCount_ATAC) from the resulting erosion scores.
}
\details{
The erosion score is calculated as:
\enumerate{
\item Normalize counts per cell to fractions.
\item Apply log transform and center across states.
\item Z-score each state across all cells.
\item Multiply z-scored states by the sign vector (+1 for repressive, -1 for active).
\item Sum across states to obtain one erosion score per cell.
}

If \code{covariates} is supplied, a linear model is fit using the
specified covariates as predictors of the erosion score. The residuals
from this model are returned as a covariate-corrected erosion score.
}
\seealso{
\code{\link{EntropyScore}}, \code{\link{CalculateStateMatrix}}
}
