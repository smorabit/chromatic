% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scoring.R
\name{EntropyScore}
\alias{EntropyScore}
\title{Calculate Cell-Level Chromatin State Entropy (Plasticity) Scores}
\usage{
EntropyScore(input, meta, pseudocount = 0.5, covariates = NULL)
}
\arguments{
\item{input}{A numeric matrix of chromatin state counts
(rows = cells, columns = states). Typically generated by \code{CalculateStateMatrix()}.}

\item{meta}{A data frame of cell-level metadata (e.g. \code{seurat_obj@meta.data}).
Required if \code{covariates} is provided.}

\item{pseudocount}{Numeric pseudocount to add to all counts before normalization
to avoid zeros. Default = 0.5.}

\item{covariates}{Optional character vector of column names in \code{meta}
specifying covariates to regress out of the entropy score. Default = \code{NULL}.}
}
\value{
A data frame with:
\itemize{
\item \code{entropy}: raw Shannon entropy score per cell (in bits).
\item \code{entropy_score_norm}: entropy normalized to 0â€“1 range by
dividing by \code{log2(n_states)}.
\item \code{entropy_score_corrected} (if \code{covariates} given):
residual entropy score with covariates regressed out.
}
}
\description{
Computes per-cell entropy scores from a chromatin state count matrix.
This function normalizes counts to fractions and then calculates
Shannon entropy for each cell to quantify the diversity of chromatin
states (a proxy for epigenomic plasticity). Optionally, it can regress
out covariates (e.g. sequencing depth, TSS enrichment) to return
a covariate-corrected entropy score.
}
\details{
For each cell:
\enumerate{
\item Convert counts to per-cell fractions with pseudocount.
\item Compute Shannon entropy of the fraction vector
(\code{entropy::entropy(p, unit="log2")}).
\item Normalize the entropy score by dividing by \code{log2(n_states)}
(maximum possible entropy) to scale it between 0 and 1.
}

If \code{covariates} is supplied, a linear model is fit with the specified
covariates as predictors of the raw entropy score. The residuals from this model
are returned as the covariate-corrected entropy score.
}
\examples{
\dontrun{
entropy_df <- EntropyScore(
  input = state_matrix,
  meta = seurat_obj@meta.data,
  covariates = c("TSS.enrichment", "nCount_ATAC")
)
}

}
\seealso{
\code{\link{ErosionScore}}, \code{\link{CalculateStateMatrix}}
}
