% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/scoring.R
\name{ExcludeUncommonPeaks}
\alias{ExcludeUncommonPeaks}
\title{Exclude Lowly Detected or Low-Count Peaks}
\usage{
ExcludeUncommonPeaks(
  peaks_gr,
  peaks_mat,
  min_cells = 100,
  min_counts = 100,
  verbose = TRUE
)
}
\arguments{
\item{peaks_gr}{A \code{GRanges} object containing the genomic coordinates
of peaks. Rows should correspond to peaks in \code{peaks_mat}.}

\item{peaks_mat}{A numeric matrix of peak counts (rows = peaks, columns = cells).}

\item{min_cells}{Integer; minimum number of cells in which a peak must be detected
(nonzero counts) to be retained. Default = \code{100}.}

\item{min_counts}{Integer; minimum total counts across all cells for a peak
to be retained. Default = \code{100}.}

\item{verbose}{Logical; if \code{TRUE}, print a message summarizing how many peaks
were retained/filtered. Default = \code{TRUE}.}
}
\value{
A named \code{list} with:
\itemize{
\item \code{peaks_gr} — the filtered \code{GRanges} object of peaks.
\item \code{peaks_mat} — the filtered peak-by-cell count matrix.
}
}
\description{
Filters out peaks that are rarely observed across cells or have
low total counts in a peak-by-cell matrix. This is a simple feature
selection step prior to downstream analyses (e.g., entropy or erosion scores).
}
\details{
The function applies two filters:
\enumerate{
\item A peak must be present (nonzero) in at least
\code{min_cells} cells.
\item A peak must have at least \code{min_counts} total counts
across all cells.
}
Peaks passing both filters are retained in the output. This step helps reduce
noise and memory usage in large peak-by-cell matrices.
}
\examples{
\dontrun{
filtered <- ExcludeUncommonPeaks(
  peaks_gr = peaks_gr,
  peaks_mat = peaks_mat,
  min_cells = 200,
  min_counts = 500,
  verbose = TRUE
)
filtered$peaks_gr
filtered$peaks_mat
}

}
\seealso{
\code{\link{AnnotatePeaks}}
}
